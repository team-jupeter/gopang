# GOPANG (고팡)

**OpenHash 기반 정부/공공기관 AI 채팅 플랫폼**

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Node.js](https://img.shields.io/badge/Node.js-18+-green.svg)](https://nodejs.org/)
[![TypeScript](https://img.shields.io/badge/TypeScript-5.0-blue.svg)](https://www.typescriptlang.org/)

---

## 📋 목차

- [개요](#-개요)
- [핵심 기술](#-핵심-기술)
- [AI 모델 아키텍처](#-ai-모델-아키텍처)
- [지원 기관](#-지원-기관)
- [시스템 구성](#-시스템-구성)
- [설치 및 실행](#-설치-및-실행)
- [API 문서](#-api-문서)
- [라이선스](#-라이선스)

---

## 🎯 개요

GOPANG(고팡)은 **OpenHash 블록체인 기술**과 **AI**를 결합한 차세대 정부/공공기관 통합 서비스 플랫폼입니다.

### 핵심 비전

- **3천만 사람 + 1천만 AI** 사용자 생태계
- 모든 정부/공공기관을 **AI 채팅**으로 연결
- **EGCT 디지털 화폐**로 통합 결제
- **Vault(정보금고)**로 개인정보 자기주권 관리
- 대화 기록 **OpenHash 분산 저장**으로 위변조 방지

### 주요 기능

| 기능 | 설명 |
|------|------|
| 🏛️ **기관 AI 상담** | 법원, 검찰, 경찰, 국세청 등 12개 기관 AI와 24시간 상담 |
| 🤖 **개인 AI 비서** | 각 사용자 전용 AI 비서 (System Prompt 편집 가능) |
| 📄 **AI Agent** | 소송 서류 작성, 병원 예약 등 자동화 작업 수행 |
| 💰 **EGCT 결제** | 블록체인 기반 디지털 화폐 (1T = 1,000원) |
| 🔐 **Vault** | 6개 서랍 구조의 개인 정보금고 |
| 📊 **자동 재무제표** | AI가 거래 분석하여 5대 재무보고서 자동 작성 |

---

## 🔧 핵심 기술

### OpenHash 블록체인

기존 블록체인 대비 **98.5% 에너지 절감**, **481배 빠른 처리 속도**를 달성한 차세대 분산원장 기술입니다.

#### 4계층 계층적 구조
```
┌─────────────────────────────────────────────────────────────┐
│                    Layer 4: 국가 (GLOBAL)                    │
│                    저장 확률: 1% | LPBFT 합의                 │
├─────────────────────────────────────────────────────────────┤
│                  Layer 3: 광역시도 (KR-JEJU)                 │
│                    저장 확률: 9% | 상향식 감시                │
├─────────────────────────────────────────────────────────────┤
│               Layer 2: 시군구 (KR-JEJU-SEOGWIPO)             │
│                   저장 확률: 30% | 하향식 검증                │
├─────────────────────────────────────────────────────────────┤
│            Layer 1: 읍면동 (KR-JEJU-SEOGWIPO-JUNGMUN)        │
│                   저장 확률: 60% | 직접 저장                  │
└─────────────────────────────────────────────────────────────┘
```

#### 핵심 모듈

| 모듈 | 코드 | 기능 |
|------|------|------|
| 확률적 계층 선택 | 300 | 해시값 기반 저장 계층 결정 |
| 하향식 검증 | 310 | 상위→하위 계층 데이터 검증 |
| 상향식 감시 | 320 | 하위→상위 계층 이상 탐지 |
| 머클 트리 동기화 | 330 | 계층 간 데이터 일관성 유지 |
| LPBFT 합의 | 340 | 경량화된 Byzantine Fault Tolerance |
| 잔액 불변성 검증 | 350 | 거래 전후 총액 일치 검증 |
| 5단계 거래 검증 | 360 | 다단계 거래 유효성 검사 |

#### 보안

- **SHA-256 이중 해싱**: 데이터 무결성 보장
- **CRYSTALS-Dilithium**: 양자 내성 전자서명
- **ECDSA P-256**: 현재 표준 디지털 서명

---

## 🤖 AI 모델 아키텍처

GOPANG은 **2개의 AI 모델**을 역할에 따라 분리 운영합니다.

### DeepSeek R1 API (상담/분석)

**역할**: 사용자와의 대화, 상담, 정보 제공, 분석
```
┌─────────────────────────────────────────────────────────────┐
│                    DeepSeek R1 API                          │
├─────────────────────────────────────────────────────────────┤
│  • 기관별 특화 System Prompt 적용                            │
│  • 사용자 Vault 데이터 참조하여 맞춤형 응답                    │
│  • 법률, 의료, 세무 등 전문 분야 상담                         │
│  • 실시간 스트리밍 응답                                      │
└─────────────────────────────────────────────────────────────┘
```

**기관별 System Prompt 예시:**

| 기관 | System Prompt 핵심 내용 |
|------|------------------------|
| 법원 | 민사/형사 소송 절차, 예상 판결, 법적 근거 조항 제시 |
| 병원 | Vault의 병력/가족력/알레르기 참조, 맞춤 병원 추천 |
| 국세청 | 소득/공제 정보 참조, 세액 계산 및 신고 안내 |
| 특허청 | 발명 자료 분석, 선행기술 조사, 출원 절차 안내 |

**API 호출 흐름:**
```
사용자 → 기관 선택 → 메시지 입력
                         ↓
              ┌─────────────────────┐
              │  기관별 System      │
              │  Prompt 선택        │
              └─────────────────────┘
                         ↓
              ┌─────────────────────┐
              │  Vault 데이터       │
              │  조회 (해당 시)      │
              └─────────────────────┘
                         ↓
              ┌─────────────────────┐
              │  DeepSeek R1 API    │
              │  호출               │
              └─────────────────────┘
                         ↓
              응답 + OpenHash 저장 확인
```

### Exaone 7.8B (AI Agent)

**역할**: 실제 작업 수행 - 서류 작성, 예약, 신청 등
```
┌─────────────────────────────────────────────────────────────┐
│                    Exaone 7.8B (Fine-tuned)                 │
├─────────────────────────────────────────────────────────────┤
│  • Agent 작업 특화 Fine-tuning 완료                          │
│  • 소송 서류 (소장, 답변서, 준비서면) 자동 작성               │
│  • 병원/관공서 예약 자동화                                   │
│  • 각종 신청서/신고서 양식 작성                              │
│  • 로컬 GPU 서버 운영 (프라이버시 보호)                      │
└─────────────────────────────────────────────────────────────┘
```

**Agent 작업 예시:**

| 기관 | Agent 작업 |
|------|-----------|
| 법원 | 소장, 답변서, 준비서면, 항소장 작성 |
| 검찰 | 고소장, 고발장, 진술서 작성 |
| 병원 | 진료 예약, 검사 예약, 의무기록 사본 신청 |
| 국세청 | 종합소득세 신고서, 부가세 신고서 작성 |
| 특허청 | 특허 명세서, 출원서 초안 작성 |
| 주민센터 | 전입신고서, 각종 증명서 신청서 작성 |

**DeepSeek ↔ Exaone 연동:**
```
사용자: "민사 소송 진행하고 싶어요"
                    ↓
┌─────────────────────────────────────────────────────────────┐
│  DeepSeek R1: 상담 진행                                      │
│  - 사건 개요 청취                                            │
│  - 원고/피고 주장 분석                                       │
│  - 예상 판결 및 비용 안내                                    │
│  - 관련 법적 근거 제시                                       │
└─────────────────────────────────────────────────────────────┘
                    ↓
            사용자: "소장 작성해주세요"
                    ↓
┌─────────────────────────────────────────────────────────────┐
│  Exaone 7.8B: Agent 작업                                    │
│  - Vault에서 당사자 정보 조회                                │
│  - 상담 내용 기반 청구취지/청구원인 작성                      │
│  - 법원 양식에 맞는 소장 문서 생성                           │
│  - PDF 출력 및 전자소송 제출 지원                            │
└─────────────────────────────────────────────────────────────┘
```

---

## 🏛️ 지원 기관

### 사법 기관

| 기관 | 아이콘 | 주요 서비스 |
|------|--------|------------|
| **법원** | ⚖️ | 민사/형사 소송 상담, 소장 작성, 판례 검색 |
| **검찰청** | 🛡️ | 고소/고발 상담, 수사 진행 안내, 피해자 보호 |
| **경찰청** | 👮 | 범죄 신고, 수사 상담, 교통/생활안전 민원 |

### 행정 기관

| 기관 | 아이콘 | 주요 서비스 |
|------|--------|------------|
| **의회** | 🏛️ | 청원 접수, 입법 예고, 의원 면담 신청 |
| **도청** | 🏢 | 광역 행정, 인허가, 보조금/지원사업 |
| **시청** | 🏙️ | 건축/도시계획, 지방세, 복지/문화 |
| **주민센터** | 🏠 | 주민등록, 증명서 발급, 복지 신청 |

### 전문 기관

| 기관 | 아이콘 | 주요 서비스 |
|------|--------|------------|
| **국세청** | 💰 | 세금 신고, 세액 계산, 세무조사 대응 |
| **특허청** | 💡 | 특허/상표/디자인 출원, 심사, 분쟁 상담 |

### 생활 기관

| 기관 | 아이콘 | 주요 서비스 |
|------|--------|------------|
| **병원** | 🏥 | 증상 분석, 병원 추천, 진료 예약 |
| **학교** | 🎓 | 입학/전학, 장학금, 진로 상담 |
| **시장** | 🛒 | 소비자 피해 구제, 상거래 분쟁 |

---

## 🏗️ 시스템 구성

### 아키텍처
```
┌─────────────────────────────────────────────────────────────┐
│                      클라이언트 (웹앱)                        │
│                   Vanilla JS + CSS 모듈화                    │
└─────────────────────────────────────────────────────────────┘
                              │ HTTPS
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                    Nginx (리버스 프록시)                     │
│                    Port 80/443 + SSL                        │
└─────────────────────────────────────────────────────────────┘
                              │
              ┌───────────────┼───────────────┐
              ▼               ▼               ▼
┌─────────────────┐ ┌─────────────────┐ ┌─────────────────┐
│ Express.js      │ │ OpenHash Node   │ │ AI Engine       │
│ Backend API     │ │ Layer 1-4       │ │ DeepSeek +      │
│ Port 3000       │ │ Port 5001-5004  │ │ Exaone 7.8B     │
└─────────────────┘ └─────────────────┘ └─────────────────┘
        │                   │                   │
        └───────────────────┼───────────────────┘
                            ▼
              ┌─────────────────────────┐
              │      SQLite Database    │
              │      /gopang/data/      │
              └─────────────────────────┘
```

### 기술 스택

| 계층 | 기술 |
|------|------|
| **Frontend** | Vanilla JS, CSS 모듈, Material Icons |
| **Backend** | Node.js 18+, Express.js, TypeScript |
| **Database** | SQLite (프로토타입) → Aurora (프로덕션) |
| **AI** | DeepSeek R1 API, Exaone 7.8B |
| **Blockchain** | OpenHash (자체 개발) |
| **Infra** | AWS EC2, Nginx, PM2 |

### 디렉토리 구조
```
/gopang
├── frontend/               # 프론트엔드
│   ├── index.html          # SPA 진입점
│   ├── css/                # 모듈화된 CSS
│   │   ├── variables.css
│   │   ├── reset.css
│   │   ├── layout.css
│   │   ├── components.css
│   │   └── chat.css
│   └── js/                 # 모듈화된 JS
│       ├── app.js
│       ├── config.js
│       ├── api/
│       ├── components/
│       ├── state/
│       └── utils/
├── backend/                # 백엔드 API
│   ├── src/
│   │   ├── index.ts
│   │   ├── routes/
│   │   └── services/
│   └── dist/               # 컴파일된 JS
├── ai-engine/              # AI 엔진
├── openhash/               # OpenHash 노드
├── docs/                   # 문서
└── data/                   # 데이터베이스
```

---

## 🚀 설치 및 실행

### 요구 사항

- Node.js 18+
- npm 9+
- Python 3.10+ (AI 엔진)
- SQLite 3

### 설치
```bash
# 1. 저장소 클론
git clone https://github.com/team-jupeter/gopang.git
cd gopang

# 2. 백엔드 설치
cd backend
npm install
cp .env.example .env
# .env 파일에 DEEPSEEK_API_KEY 설정

# 3. 빌드
npm run build

# 4. 실행
npm start
```

### 환경 변수
```env
# .env
PORT=3000
DEEPSEEK_API_KEY=your_api_key_here
DATABASE_PATH=/gopang/data/gopang.db
NODE_ENV=production
```

### 접속

- **웹앱**: https://your-domain.com/
- **API**: https://your-domain.com/api/
- **테스트 계정**: SGP-JM-01 / 1

---

## 📚 API 문서

### 인증 API
```
POST /api/auth-unified/login/phone
Body: { "identifier": "SGP-JM-01", "password": "1" }
```

### AI 채팅 API
```
POST /api/ai-chat/chat
Body: {
  "message": "민사 소송하고 싶어요",
  "userId": "SGP-JM-01",
  "aiType": "court"    // 선택한 기관
}
```

### 거래 API
```
GET  /api/trading/products          # 상품 목록
POST /api/trading/orders            # 주문 생성
GET  /api/trading/financial/:id     # 재무제표 조회
```

---

## 💰 EGCT 디지털 화폐

**EGCT** (Electronic Government Currency Token)

- **단위**: T (Token)
- **교환비**: 1T = 1,000원
- **용도**: 정부/공공 서비스 결제

| 예시 | 금액 |
|------|------|
| 자판기 음료 | 1T |
| 짜장면 | 8T |
| 피자 | 25T |
| 소송 인지대 | 50T |
| 월급 | 5,000T |

---

## 🔐 Vault (정보금고)

개인정보 자기주권 관리 시스템

### 6개 서랍 구조

| 서랍 | 저장 정보 |
|------|----------|
| 📋 **신분** | 주민등록, 운전면허, 여권 |
| 💊 **의료** | 병력, 처방, 건강검진 |
| 💰 **금융** | 계좌, 카드, 거래내역 |
| 📄 **계약** | 부동산, 근로, 보험 |
| 🎓 **학력** | 졸업증명, 성적, 자격증 |
| 📁 **기타** | 기타 문서 |

---

## 📄 라이선스

MIT License

Copyright (c) 2026 Team Jupeter

---

## 🤝 기여

이슈 및 PR 환영합니다.

## 📞 문의

- GitHub: [@team-jupeter](https://github.com/team-jupeter)
- Email: tensor.city@gmail.com
